import{b as c,A as P,d as q,e as m,f,h as e,m as V,t as k,H as F,N as B,j as p,O as N,k as x,K as M,a as $,n as T,w as L,F as C,B as D,G as j,I as A,J as K}from"./index-f788ecf7.js";import{a as Y,_ as E,b as I}from"./Modal-506d2c4d.js";import{d as g}from"./dayjs.min-02090ccb.js";import{_ as U}from"./FermentationInput-7dd622a5.js";import{F as J}from"./FermentationSelect-e72acec7.js";import{u as z}from"./useAlarm-ab269f11.js";import{c as O}from"./cloneDeep-bcfefedb.js";import"./menu-97f65ddc.js";import"./multiselect-ae90ff62.js";import"./plugin-vueexport-helper-c27b6911.js";const G={class:"form-group"},Q={class:"mg-b-10"},W={class:"text-danger"},X={class:"invalid-feedback"},S={__name:"FermentationDatePicker",props:{modelValue:[String,Array],error:String,label:String,required:Boolean},emits:["update:modelValue"],setup(h,{emit:_}){const u=h,i=c(u.modelValue);return P(()=>u.modelValue,d=>{i.value=d}),(d,s)=>{const v=q("Datepicker");return m(),f("div",G,[e("p",Q,[V(k(h.label)+" ",1),F(e("span",W,"*",512),[[B,h.required]])]),p(v,N({modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=b=>i.value=b)},d.$attrs,{class:{"is-invalid":!x(M)(h.error)}}),null,16,["modelValue","class"]),e("div",X,k(h.error),1)])}}},Z={class:"row"},ee={class:"col-lg-6 col-sm-12"},te={class:"col-lg-6 col-sm-12"},ae={key:0,class:"col-12"},oe={class:"col-lg-6 col-sm-12"},le={class:"col-lg-6 col-sm-12"},se={__name:"FormModal",setup(h,{expose:_}){const{alarms:u}=z(),i=c(null),d=c("create"),s=$(()=>{let n="";switch(d.value){case"create":n="新增專案資料";break;case"update":n="更新專案資料";break}return n}),v=$(()=>u.value.map(n=>n.targetDevice)),b={name:"",targetDevice:"",startTime:"",endTime:""},w=c([]),y=()=>O(b),t=c(y()),a=$(()=>g().isAfter(t.value.startTime));return _({show:(n,l)=>{d.value=n,t.value=y(),l&&(t.value=O(l)),w.value=[t.value.startTime,t.value.endTime],i.value.show()}}),(n,l)=>(m(),T(Y,{ref_key:"modalRef",ref:i,"dialog-class":"modal-content-demo",title:s.value},{footer:L(()=>[e("button",{href:"javascript:;",class:"btn btn-md btn-info",onClick:l[5]||(l[5]=r=>i.value.hide())}," 取消 "),e("button",{href:"javascript:;",class:"btn btn-md btn-danger",onClick:l[6]||(l[6]=r=>i.value.hide())}," 送出 ")]),default:L(()=>[e("div",Z,[e("div",ee,[p(U,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=r=>t.value.name=r),label:"專案名稱",required:"",placeholder:"請輸入專案名稱"},null,8,["modelValue"])]),e("div",te,[p(J,{modelValue:t.value.targetDevice,"onUpdate:modelValue":l[1]||(l[1]=r=>t.value.targetDevice=r),options:v.value,label:"目標裝置",required:"",placeholder:"請輸入目標裝置"},null,8,["modelValue","options"])]),d.value==="create"||!a.value?(m(),f("div",ae,[p(S,{modelValue:w.value,"onUpdate:modelValue":l[2]||(l[2]=r=>w.value=r),range:"",label:"起始時間-結束時間","min-date":x(g)(),placeholder:"請選擇起訖時間",format:"yyyy/MM/dd HH:mm",required:""},null,8,["modelValue","min-date"])])):(m(),f(C,{key:1},[e("div",oe,[p(U,{modelValue:t.value.startTime,"onUpdate:modelValue":l[3]||(l[3]=r=>t.value.startTime=r),label:"起始時間",disabled:""},null,8,["modelValue"])]),e("div",le,[p(S,{modelValue:t.value.endTime,"onUpdate:modelValue":l[4]||(l[4]=r=>t.value.endTime=r),"min-date":x(g)(),label:"結束時間",placeholder:"請選擇結束時間",format:"yyyy/MM/dd HH:mm",required:""},null,8,["modelValue","min-date"])])],64))])]),_:1},8,["title"]))}},ne={class:"userlist-table"},re={class:"table card-table table-striped table-vcenter text-nowrap mb-0"},ie=["colspan"],de={__name:"LogsModal",setup(h,{expose:_}){const u=c(null),i=c(""),d=c([]),s=c([]),v=(t="")=>{const a=t.toLocaleLowerCase();return a==="Temp".toLocaleLowerCase()?"⸰C":a==="Rpm".toLocaleLowerCase()?"rpm":a==="CO2".toLocaleLowerCase()?"PPM":a==="O2".toLocaleLowerCase()?"%":a==="Lux".toLocaleLowerCase()?"lux":a.includes("Pump".toLocaleLowerCase())&&a.includes("flow".toLocaleLowerCase())?"L":a.includes("RH".toLocaleLowerCase())?"%":""},b=t=>["Time".toLocaleLowerCase(),"Temp".toLocaleLowerCase(),"Rpm".toLocaleLowerCase(),"pH".toLocaleLowerCase(),"ORP".toLocaleLowerCase(),"CO2".toLocaleLowerCase(),"O2".toLocaleLowerCase(),"Lux".toLocaleLowerCase(),"RH".toLocaleLowerCase()].includes(t)?!0:!!(t.includes("Pump".toLocaleLowerCase())&&t.includes("flow".toLocaleLowerCase())),w=t=>{const a=t.split(/\r\n|\n/),o=a[0].split(",");let n=[];d.value=o.filter(r=>{if(b(r.toLocaleLowerCase()))return r});for(let r=1;r<a.length;r++){let H=a[r].split(",");if(H.length==o.length){let R=[];for(var l=0;l<o.length;l++)b(o[l].toLocaleLowerCase())&&R.push(`${H[l]}${v(o[l])}`);n.push(R)}}return n},y=async()=>{const a=await(await fetch("Reform_20231024.csv",{method:"get",headers:{"content-type":"text/csv;charset=UTF-8"}})).text();s.value=w(a)};return _({show:t=>{i.value=t,u.value.show(),y()}}),(t,a)=>(m(),T(Y,{ref_key:"modalRef",ref:u,title:i.value,"dialog-class":"modal-lg modal-dialog-scrollable"},{default:L(()=>[e("div",ne,[e("table",re,[e("thead",null,[e("tr",null,[(m(!0),f(C,null,D(d.value,o=>(m(),f("th",{key:o},k(o),1))),128))])]),e("tbody",null,[s.value.length>0?(m(!0),f(C,{key:0},D(s.value,o=>(m(),f("tr",{key:o},[(m(!0),f(C,null,D(o,n=>(m(),f("td",null,k(n),1))),256))]))),128)):(m(),f("td",{key:1,colspan:d.value.length,class:"text-center"}," 查無資料 ",8,ie))])])])]),_:1},8,["title"]))}},ce={__name:"DeleteModal",setup(h,{expose:_}){const u=c(null),i=c("");return _({show:d=>{var s;i.value=d,(s=u.value)==null||s.show()}}),(d,s)=>(m(),T(Y,{ref_key:"modalRef",ref:u,"body-class":"text-center","dialog-class":"modal-dialog-centered",title:"刪除專案"},{footer:L(()=>[e("button",{href:"javascript:;",class:"btn btn-md btn-info",onClick:s[0]||(s[0]=v=>u.value.hide())}," 取消 "),e("button",{href:"javascript:;",class:"btn btn-md btn-danger",onClick:s[1]||(s[1]=v=>u.value.hide())}," 確定 ")]),default:L(()=>[V(" 確認是否刪除"+k(i.value)+" ",1)]),_:1},512))}},ue={class:"row row-sm"},me={class:"col-sm-12 col-md-12 col-lg-12 col-xl-12 grid-margin"},ve={class:"card custom-card"},fe={class:"card-header border-bottom-0 pb-0"},pe={class:"row"},_e={class:"col-12"},be={class:"d-flex flex-column flex-lg-row justify-content-between"},he={class:"input-group wd-lg-25p"},ge={class:"input-group-append"},we={class:"card-body"},ye=["onClick"],Le=e("i",{class:"fe fe-edit-2"},null,-1),ke=[Le],Ce=["onClick"],$e=e("i",{class:"mdi mdi-database"},null,-1),De=[$e],xe=["onClick"],Me=e("i",{class:"fe fe-trash"},null,-1),Ve=[Me],Te="專案管理",Ne={__name:"index",setup(h){const _=j({keyword:""}),u=[{label:"專案名稱",key:"name"},{label:"目標裝置",key:"targetDevice"},{label:"起始時間",key:"startTime"},{label:"結束時間",key:"endTime"},{label:"操作",key:"action",tdClassName:"btn-list"}],i=c({total:10,size:10,page:1}),d=[{id:"1",name:"紀錄1",targetDevice:"醱酵槽1",startTime:g().subtract(1,"day").format("YYYY/MM/DD HH:mm"),endTime:g().add(2,"day").format("YYYY/MM/DD HH:mm")},{id:"2",name:"紀錄2",targetDevice:"離心機1",startTime:g().format("YYYY/MM/DD HH:mm"),endTime:g().add(2,"day").format("YYYY/MM/DD HH:mm")},{id:"3",name:"紀錄3",targetDevice:"離心機1",startTime:g().add(1,"day").format("YYYY/MM/DD HH:mm"),endTime:g().add(2,"day").format("YYYY/MM/DD HH:mm")}],s=c(d),v=(t=1,a=10)=>{const o={..._,page:t,limit:a};M(o.keyword)?M(o.keyword)&&(s.value=d):s.value=s.value.filter(n=>n.name.includes(o.keyword)|n.targetDevice),i.value.total=s.value.length},b=c(null),w=c(null),y=c(null);return(t,a)=>(m(),f(C,null,[p(I,{title:Te}),e("div",ue,[e("div",me,[e("div",ve,[e("div",fe,[e("div",pe,[e("div",_e,[e("div",be,[e("button",{type:"button",class:"btn btn-primary mb-2 mb-lg-0",onClick:a[0]||(a[0]=o=>b.value.show("create"))},"新增專案"),e("div",he,[F(e("input",{type:"text",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=o=>_.keyword=o),placeholder:"搜尋專案名稱、裝置",onKeyup:a[2]||(a[2]=K(o=>v(1),["enter"]))},null,544),[[A,_.keyword]]),e("span",ge,[e("button",{class:"btn btn-primary",type:"button",onClick:a[3]||(a[3]=o=>v(1))}," 搜尋 ")])])])])])]),e("div",we,[p(E,{header:u,items:s.value,"page-change":v,pagination:i.value},{laboratory:L(({value:o})=>[V(k(o.join("、")),1)]),action:L(({item:o})=>[e("button",{class:"btn btn-sm btn-danger",onClick:n=>b.value.show("update",o)},ke,8,ye),e("button",{class:"btn btn-sm btn-primary",onClick:n=>y.value.show(o.name)},De,8,Ce),e("button",{class:"btn btn-sm btn-info",onClick:n=>w.value.show(o.name)},Ve,8,xe)]),_:1},8,["items","pagination"])])])]),p(se,{ref_key:"formModalRef",ref:b},null,512),p(de,{ref_key:"logsModalRef",ref:y},null,512),p(ce,{ref_key:"deleteModalRef",ref:w},null,512)])],64))}};export{Ne as default};
